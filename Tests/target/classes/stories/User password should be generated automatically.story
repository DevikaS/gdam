!--NGN-521
Feature:          User password should be generated automatically
Narrative:
In order to
As a              AgencyAdmin
I want to         Check if user password can be generated automatically

Scenario: Impossibility editing password if auto generation
Meta: @gdam
@projects
Given I am on Create New User page
When I 'check' 'Generate password automatically' checkbox
Then I should see element 'PasswordField' on page 'UserEdit' in following state 'disabled'


Scenario: User receives email with auto generated password even if password filled
Meta: @gdam
@gdamemails
Given I am on Create New User page
When I fill 'MandatoryFields' for 'Upsbga_U5' user
And I fill fields on page 'UserEdit' in the following values:
| field         | value |
| PasswordField | 123   |
And I 'check' 'Generate password automatically' checkbox
And I click save on Create new user page
Then the user 'Upsbga_U5' should receive Login details email and email 'should not' contain password '123'


Scenario: User can log in system using received password
Meta: @gdam
@gdamemails
Given I am on Create New User page
When I fill 'MandatoryFields' for 'Upsbga_U7' user
And I 'check' 'Generate password automatically' checkbox
And I click save on Create new user page
And I logout from account
And I open link from reset passwords email and type generated password when user 'Upsbga_U7' received email with next subject 'Your new Adbank login details'
Then I should see that user 'Upsbga_U7' is logged now


Scenario: User can change password generated automatically
Meta: @gdam
@gdamemails
Given I am on Create New User page
When I fill 'MandatoryFields' for 'Upsbga_U8' user
And I 'check' 'Generate password automatically' checkbox
And I click save on Create new user page
And I logout from account
And open link from email with subject 'Your new Adbank login details' that was send to user 'Upsbga_U8' and type automatically generated password
And I go to my Account Setting page
And change current user 'Upsbga_U8' password generated automatically that was in email with subject 'Your new Adbank login details' to following new password 'zxcvbsdfA1' confirm password 'zxcvbsdfA1' on my Account Settings page
Then I should see message warning 'New password has been set to user'


Scenario: User can log in with new password
Meta: @gdam
@gdamemails
Given I am on Create New User page
When I fill 'MandatoryFields' for 'Upsbga_U9' user
And I 'check' 'Generate password automatically' checkbox
And I click save on Create new user page
And I logout from account
And open link from email with subject 'Your new Adbank login details' that was send to user 'Upsbga_U9' and type automatically generated password
And I go to my Account Setting page
And change current user 'Upsbga_U9' password generated automatically that was in email with subject 'Your new Adbank login details' to following new password 'abcdefghA1' confirm password 'abcdefghA1' on my Account Settings page
And I logout from account
And I login with details of 'Upsbga_U9'
Then I should see that user 'Upsbga_U9' is logged now


Scenario: User no longer can log in with automatically generated password
Meta: @gdam
@gdamemails
Given I am on Create New User page
When I fill 'MandatoryFields' for 'Upsbga_U10' user
And I 'check' 'Generate password automatically' checkbox
And I click save on Create new user page
And change current user's password generated automatically that was in email with subject 'Your new Adbank login details' to following new password 'abcdefghA1' confirm password 'abcdefghA1' on user 'Upsbga_U10' Account Settings page
And I logout from account
And open link from email with subject 'Your new Adbank login details' that was send to user 'Upsbga_U10' and type automatically generated password
And click on element 'LoginButton'
Then I 'should' see 'error' message notification 'The username and password do not match.' on Login page


Scenario: Check that forgot password is successfully works for user with autogenerated password
Meta: @gdam
@gdamemails
Given I am on Create New User page
When I fill 'MandatoryFields' for 'Upsbga_U11' user
And I 'check' 'Generate password automatically' checkbox
And I click save on Create new user page
And I logout from account
And click Reset Password button after typed in the field Email on Reset Password popup following email 'Upsbga_U11'
And I open link from reset passwords email and type generated password when user 'Upsbga_U11' received email with next subject 'Your new Adbank login details'
Then I should see that user 'Upsbga_U11' is logged now